---
import type { CollectionEntry } from "astro:content";
import { Image } from "astro:assets";
import { slugifyAll } from "@/utils/slugify";

type Props = CollectionEntry<"library">;

const { id, data } = Astro.props;
const { title, bookAuthor, genre, coverImage, dateRead } = data;

const dateStr = dateRead.toLocaleDateString("en-US", {
  year: "numeric",
  month: "short",
});
---

<li
  class="overflow-hidden rounded-lg border border-border-subtle bg-bg-elevated transition-colors hover:border-accent-primary-muted hover:bg-bg-hover"
  data-genre={slugifyAll(genre).join(",")}
>
  <a href={`/library/${id}/`} class="flex h-full flex-col">
    <div class="overflow-hidden">
      <Image
        src={coverImage}
        alt={`Cover of ${title}`}
        width={240}
        height={360}
        class="w-full object-cover"
        loading="lazy"
      />
    </div>
    <div class="flex flex-1 flex-col gap-2 p-4">
      <h2 class="leading-snug font-medium text-white">{title}</h2>
      <p class="text-sm text-text-secondary">{bookAuthor}</p>
      <ul class="flex flex-wrap gap-x-2 gap-y-1">
        {genre.map(g => <li class="text-xs text-accent-primary">{g}</li>)}
      </ul>
      <p class="mt-auto pt-1 text-xs text-text-muted">{dateStr}</p>
    </div>
  </a>
</li>
