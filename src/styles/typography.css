/* Hand-rolled prose styles — replaces @tailwindcss/typography */
/* All colors reference CSS custom properties defined via src/theme.ts → Layout.astro */

@layer base {
  /* ===== Base font size ===== */
  html {
    font-size: 18px;
  }

  /* ===== .app-prose — reading content wrapper ===== */
  .app-prose {
    color: var(--text-primary);
    line-height: 1.8;
    font-size: 1rem;

    /* ----- Headings ----- */
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      font-family: inherit;
      text-transform: none;
      letter-spacing: 0;
      margin-bottom: 0.75rem;
    }

    h1 {
      font-size: 2.2rem;
      font-weight: 600;
      line-height: 1.2;
      margin-top: 0;
      color: var(--heading-hero);
    }

    h2 {
      font-size: 1.6rem;
      font-weight: 600;
      line-height: 1.3;
      margin-top: 3rem;
      color: var(--heading);
    }

    h3 {
      font-size: 1.3rem;
      font-weight: 500;
      line-height: 1.4;
      margin-top: 2.5rem;
      color: var(--heading);
    }

    h4 {
      font-size: 1.1rem;
      font-weight: 500;
      line-height: 1.4;
      margin-top: 2.5rem;
      color: var(--heading);
    }

    h5,
    h6 {
      font-size: 1rem;
      font-weight: 500;
      line-height: 1.5;
      margin-top: 2.5rem;
      color: var(--heading);
    }

    /* ----- Paragraphs ----- */
    p {
      margin-bottom: 1.6rem;
    }

    /* ----- Links ----- */
    a {
      color: var(--accent-primary);
      text-decoration: none;
      overflow-wrap: break-word;
      word-break: break-word;
    }

    a:hover {
      color: var(--accent-primary-hover);
      text-decoration: underline;
      text-underline-offset: 4px;
    }

    a:focus-visible {
      text-decoration: none;
      outline: 2px dashed var(--accent-primary);
      outline-offset: 2px;
    }

    /* ----- Strong / Em ----- */
    strong {
      font-weight: 700;
      color: var(--text-primary);
    }

    em {
      font-style: italic;
    }

    /* ----- Lists ----- */
    ul,
    ol {
      padding-left: 1.5rem;
      margin-bottom: 1.6rem;
    }

    ul {
      list-style-type: disc;
      overflow-x: clip;
    }

    ol {
      list-style-type: decimal;
    }

    li {
      margin-bottom: 0.4rem;
    }

    li::marker {
      color: var(--accent-primary);
    }

    li > ul,
    li > ol {
      margin-top: 0.4rem;
      margin-bottom: 0.4rem;
    }

    /* ----- Blockquotes ----- */
    blockquote {
      border-left: 3px solid var(--accent-primary-muted);
      padding-left: 1rem;
      margin: 2rem 0;
      overflow-wrap: break-word;
      color: var(--accent-secondary);
      font-style: italic;
    }

    blockquote > p {
      margin-bottom: 0.5rem;
    }

    blockquote > p:last-child {
      margin-bottom: 0;
    }

    /* ----- Horizontal rule ----- */
    hr {
      border: none;
      border-top: 1px solid var(--border-subtle);
      margin: 3rem 0;
    }

    /* ----- Images ----- */
    img {
      display: block;
      margin-left: auto;
      margin-right: auto;
      max-width: 100%;
      height: auto;
      border: 1px solid var(--border-subtle);
    }

    /* ----- Figcaption ----- */
    figcaption {
      text-align: center;
      font-size: 0.875rem;
      color: var(--text-muted);
      margin-top: 0.5rem;
    }

    /* ----- Inline code ----- */
    code {
      font-family: inherit;
      font-size: 0.9em;
      background-color: var(--code-bg);
      border: 1px solid var(--border-subtle);
      padding: 2px 6px;
      border-radius: 4px;
      overflow-wrap: break-word;
      word-break: break-word;
    }

    code::before,
    code::after {
      content: none;
    }

    /* ----- Code blocks ----- */
    pre {
      background-color: var(--code-bg);
      border: 1px solid var(--border-subtle);
      border-radius: 6px;
      padding: 1.4rem;
      overflow-x: auto;
      margin-bottom: 1.6rem;
      font-size: 0.95rem;
    }

    pre code {
      background-color: transparent;
      border: none;
      padding: 0;
      font-size: inherit;
    }

    pre:focus-visible {
      border-color: transparent;
      outline: 2px dashed var(--accent-primary);
    }

    /* ----- Tables ----- */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 1.6rem;
      font-size: 0.95rem;
    }

    th,
    td {
      border: 1px solid var(--border-subtle);
      padding: 0.5rem 0.75rem;
      text-align: left;
    }

    th {
      background-color: var(--bg-elevated);
      font-weight: 600;
      padding-top: 0.375rem;
      padding-bottom: 0.375rem;
      color: var(--text-primary);
    }

    td code {
      word-break: break-all;
    }

    @media (min-width: 640px) {
      td code {
        word-break: normal;
      }
    }

    /* ----- Details / Summary ----- */
    details {
      display: inline-block;
      cursor: pointer;
      color: var(--text-primary);
      user-select: none;
    }

    details p {
      display: none;
    }

    details ul {
      margin-top: 0 !important;
    }

    summary:focus-visible {
      outline: 2px dashed var(--accent-primary);
      outline-offset: 1px;
      text-decoration: none;
    }

    /* inner <code> inside .astro-code preserves code block bg */
    .astro-code code {
      flex: 1 0 100%;
      background: inherit;
      padding: 0;
    }
  }

  /* ===== Code Blocks & Syntax Highlighting ===== */
  /* vitesse-dark single theme — token colors are inline styles from Shiki */
  .astro-code {
    display: flex;
    background-color: var(--code-bg) !important;
    border: 1px solid var(--border-subtle);
  }

  /* ===== Shiki transformer styles ===== */
  /* https://shiki.style/packages/transformers */
  .astro-code {
    .line.diff.add {
      @apply relative inline-block w-full bg-green-400/20 before:absolute before:-left-3 before:text-green-500 before:content-['+'];
    }
    .line.diff.remove {
      @apply relative inline-block w-full bg-red-500/20 before:absolute before:-left-3 before:text-red-500 before:content-['-'];
    }
    .line.highlighted {
      @apply inline-block w-full bg-slate-400/20;
    }
    .highlighted-word {
      border: 1px solid var(--border-subtle);
      border-radius: 2px;
      padding: 0 2px;
    }
  }
}
